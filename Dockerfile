FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCiAgLSBtb2JpbGUtY2xpZW50LWVuYWJsZWQKbWV0YWRhdGE6CiAg\
ZGlzcGxheU5hbWU6IFVuaWZpZWQgUHVzaCBTZXJ2ZXIKICBsb25nRGVzY3JpcHRpb246ICJBbiBB\
UEIgZGVwbG95aW5nIHRoZSBBZXJvR2VhciBVbmlmaWVkUHVzaCBTZXJ2ZXIgd2l0aCBwZXJzaXN0\
ZW50IHN0b3JhZ2UgYW5kIGF1dGhlbnRpY2F0aW9uIHRocm91Z2ggT3BlbnNoaWZ0IgogIGltYWdl\
VXJsOiAiaHR0cHM6Ly9wYnMudHdpbWcuY29tL3Byb2ZpbGVfaW1hZ2VzLzE3OTQ0NDAwMDUvYWVy\
b2dlYXJfaWNvbi0xXzQwMHg0MDAucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2dp\
dGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2Nz\
L21vZHVsZXMvdXBzX29wZW5zaGlmdC9pbmRleC5hc2NpaWRvYyIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6CiAgICAtICJkb2NrZXIuaW8vYWVy\
b2dlYXIvdW5pZmllZHB1c2gtd2lsZGZseS1wbGFpbjoyLjAuMiIKICAgIC0gImRvY2tlci5pby9j\
ZW50b3MvcG9zdGdyZXNxbC05Ni1jZW50b3M3OjkuNiIKICAgIC0gImRvY2tlci5pby9hZXJvZ2Vh\
ci91cHMtY29uZmlnLW9wZXJhdG9yOm1hc3RlciIKICAgIC0gImRvY2tlci5pby9vcGVuc2hpZnQv\
b2F1dGgtcHJveHk6djEuMS4wIgogIHNlcnZpY2VOYW1lOiB1cHMKcGxhbnM6CiAgLSBuYW1lOiBk\
ZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogUGVyc2lzdGVudCBkZXBsb3ltZW50IG9mIFVQUwogICAg\
ZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IHt9CiAgICBwYXJhbWV0ZXJzOiBbXQogICAgYmluZF9w\
YXJhbWV0ZXJzOgogICAgLSBuYW1lOiBDTElFTlRfSUQKICAgICAgcmVxdWlyZWQ6IFRydWUKICAg\
ICAgdGl0bGU6IE1vYmlsZSBDbGllbnQgSUQKICAgICAgdHlwZTogc3RyaW5nCiAgICAtIG5hbWU6\
IENMSUVOVF9UWVBFCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIHRpdGxlOiBNb2JpbGUgQ2xp\
ZW50IFR5cGUKICAgICAgdHlwZTogZW51bQogICAgICBkZWZhdWx0OiAiQW5kcm9pZCIKICAgICAg\
ZW51bTogWyJBbmRyb2lkIiwgIklPUyJdCiAgICAtIG5hbWU6IGdvb2dsZWtleQogICAgICB0aXRs\
ZTogWW91ciBHb29nbGUgS2V5IGZvciBGaXJlYmFzZSBDbG91ZCBNZXNzYWdpbmcKICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEFuZHJvaWQKICAgIC0gbmFtZTogcHJvamVj\
dE51bWJlcgogICAgICB0aXRsZTogWW91ciBGQ00gUHJvamVjdCBOdW1iZXIsIG5lZWRlZCBvbiB0\
aGUgbW9iaWxlIGNsaWVudCBmb3IgY29ubmVjdGluZyB3aXRoIEZDTQogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgZGlzcGxheV9ncm91cDogQW5kcm9pZAogICAgLSBuYW1lOiBjZXJ0CiAgICAgIHRp\
dGxlOiBpT1MgLnAxMiBmaWxlIChlbmNvZGUgY29udGVudHMgaW4gYmFzZTY0IGJlZm9yZSBwYXN0\
aW5nKQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAg\
ICBkaXNwbGF5X2dyb3VwOiBpT1MKICAgIC0gbmFtZTogcGFzc3BocmFzZQogICAgICB0aXRsZTog\
VGhlIHBhc3NwaHJhc2UKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTogcGFz\
c3dvcmQKICAgICAgZGlzcGxheV9ncm91cDogaU9TCiAgICAtIG5hbWU6IGlvc0lzUHJvZHVjdGlv\
bgogICAgICB0aXRsZTogSXMgdGhpcyBhIHByb2R1Y3Rpb24gY2VydGlmaWNhdGU/CiAgICAgIHR5\
cGU6IGJvb2xlYW4KICAgICAgZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICBkaXNwbGF5X2dy\
b3VwOiBpT1MK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb