FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCiAgLSBtb2JpbGUtY2xpZW50LWVuYWJsZWQKbWV0YWRhdGE6CiAg\
ZGlzcGxheU5hbWU6IFVuaWZpZWQgUHVzaCBTZXJ2ZXIKICBsb25nRGVzY3JpcHRpb246ICJBbiBB\
UEIgZGVwbG95aW5nIHRoZSBBZXJvR2VhciBVbmlmaWVkUHVzaCBTZXJ2ZXIgd2l0aCBwZXJzaXN0\
ZW50IHN0b3JhZ2UgYW5kIGF1dGhlbnRpY2F0aW9uIHRocm91Z2ggT3BlbnNoaWZ0IgogIGltYWdl\
VXJsOiAiaHR0cHM6Ly9wYnMudHdpbWcuY29tL3Byb2ZpbGVfaW1hZ2VzLzE3OTQ0NDAwMDUvYWVy\
b2dlYXJfaWNvbi0xXzQwMHg0MDAucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2dp\
dGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2Nz\
L21vZHVsZXMvdXBzX29wZW5zaGlmdC9pbmRleC5hc2NpaWRvYyIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6CiAgICAtICJkb2NrZXIuaW8vYWVy\
b2dlYXIvdW5pZmllZHB1c2gtd2lsZGZseS1wbGFpbjoyLjEuMCIKICAgIC0gImRvY2tlci5pby9j\
ZW50b3MvcG9zdGdyZXNxbC05Ni1jZW50b3M3OjkuNiIKICAgIC0gImRvY2tlci5pby9hZXJvZ2Vh\
ci91cHMtY29uZmlnLW9wZXJhdG9yOm1hc3RlciIKICAgIC0gImRvY2tlci5pby9vcGVuc2hpZnQv\
b2F1dGgtcHJveHk6djEuMS4wIgogIHNkay1kb2NzLWFuZHJvaWQ6ICJodHRwOi8vZG9jcy5hZXJv\
Z2Vhci5vcmciCiAgc2RrLWRvY3MtY29yZG92YTogImh0dHA6Ly9kb2NzLmFlcm9nZWFyLm9yZyIK\
ICBzZGstZG9jcy1pb3M6ICJodHRwOi8vZG9jcy5hZXJvZ2Vhci5vcmciCiAgc2RrLWRvY3MteGFt\
YXJpbjogImh0dHA6Ly9kb2NzLmFlcm9nZWFyLm9yZyIKICBzZXJ2aWNlTmFtZTogdXBzCnBsYW5z\
OgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFBlcnNpc3RlbnQgZGVwbG95bWVu\
dCBvZiBVUFMKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBtb2JpbGVjbGllbnRf\
YmluZF9wYXJhbWV0ZXJzX2RhdGE6CiAgICAgICAgLSAneyJuYW1lIjogIkNMSUVOVF9JRCIsICJ2\
YWx1ZSI6ICJtZXRhZGF0YS5uYW1lIiwgInR5cGUiOiAicGF0aCJ9JwogICAgcGFyYW1ldGVyczog\
W10KICAgIGJpbmRfcGFyYW1ldGVyczoKICAgIC0gbmFtZTogQ0xJRU5UX0lECiAgICAgIHJlcXVp\
cmVkOiBUcnVlCiAgICAgIHRpdGxlOiBNb2JpbGUgQ2xpZW50IElECiAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgLSBuYW1lOiBDTElFTlRfVFlQRQogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICB0aXRs\
ZTogTW9iaWxlIENsaWVudCBUeXBlCiAgICAgIHR5cGU6IGVudW0KICAgICAgZGVmYXVsdDogIkFu\
ZHJvaWQiCiAgICAgIGVudW06IFsiQW5kcm9pZCIsICJJT1MiXQogICAgLSBuYW1lOiBnb29nbGVr\
ZXkKICAgICAgdGl0bGU6IFlvdXIgR29vZ2xlIEtleSBmb3IgRmlyZWJhc2UgQ2xvdWQgTWVzc2Fn\
aW5nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X2dyb3VwOiBBbmRyb2lkCiAgICAt\
IG5hbWU6IHByb2plY3ROdW1iZXIKICAgICAgdGl0bGU6IFlvdXIgRkNNIFByb2plY3QgTnVtYmVy\
LCBuZWVkZWQgb24gdGhlIG1vYmlsZSBjbGllbnQgZm9yIGNvbm5lY3Rpbmcgd2l0aCBGQ00KICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEFuZHJvaWQKICAgIC0gbmFtZTog\
Y2VydAogICAgICB0aXRsZTogaU9TIC5wMTIgZmlsZSAoZW5jb2RlIGNvbnRlbnRzIGluIGJhc2U2\
NCBiZWZvcmUgcGFzdGluZykKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTog\
dGV4dGFyZWEKICAgICAgZGlzcGxheV9ncm91cDogaU9TCiAgICAtIG5hbWU6IHBhc3NwaHJhc2UK\
ICAgICAgdGl0bGU6IFRoZSBwYXNzcGhyYXNlCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNw\
bGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIGRpc3BsYXlfZ3JvdXA6IGlPUwogICAgLSBuYW1lOiBp\
b3NJc1Byb2R1Y3Rpb24KICAgICAgdGl0bGU6IElzIHRoaXMgYSBwcm9kdWN0aW9uIGNlcnRpZmlj\
YXRlPwogICAgICBkZWZhdWx0OiBmYWxzZQogICAgICB0eXBlOiBib29sZWFuCiAgICAgIGRpc3Bs\
YXlfdHlwZTogY2hlY2tib3gKICAgICAgZGlzcGxheV9ncm91cDogaU9TCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb