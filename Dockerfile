FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCiAgLSBtb2JpbGUtY2xpZW50LWVuYWJsZWQKbWV0YWRhdGE6CiAg\
ZGlzcGxheU5hbWU6IFVuaWZpZWQgUHVzaCBTZXJ2ZXIKICBsb25nRGVzY3JpcHRpb246ICJBbiBB\
UEIgZGVwbG95aW5nIHRoZSBBZXJvR2VhciBVbmlmaWVkUHVzaCBTZXJ2ZXIgd2l0aCBwZXJzaXN0\
ZW50IHN0b3JhZ2UgYW5kIGF1dGhlbnRpY2F0aW9uIHRocm91Z2ggT3BlbnNoaWZ0IgogIGltYWdl\
VXJsOiAiaHR0cHM6Ly9wYnMudHdpbWcuY29tL3Byb2ZpbGVfaW1hZ2VzLzE3OTQ0NDAwMDUvYWVy\
b2dlYXJfaWNvbi0xXzQwMHg0MDAucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2dp\
dGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2Nz\
L21vZHVsZXMvdXBzX29wZW5zaGlmdC9pbmRleC5hc2NpaWRvYyIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6CiAgICAtICJkb2NrZXIuaW8vYWVy\
b2dlYXIvdW5pZmllZHB1c2gtd2lsZGZseS1wbGFpbjoyLjEuMCIKICAgIC0gImRvY2tlci5pby9j\
ZW50b3MvcG9zdGdyZXNxbC05Ni1jZW50b3M3OjkuNiIKICAgIC0gImRvY2tlci5pby9hZXJvZ2Vh\
ci91cHMtY29uZmlnLW9wZXJhdG9yOm1hc3RlciIKICAgIC0gImRvY2tlci5pby9vcGVuc2hpZnQv\
b2F1dGgtcHJveHk6djEuMS4wIgogIHNkay1kb2NzLWFuZHJvaWQ6ICJodHRwczovL2RvY3MuYWVy\
b2dlYXIub3JnL2FuZHJvaWQtc2RrL2xhdGVzdC9nZXR0aW5nLXN0YXJ0ZWQvcHVzaC5odG1sIgog\
IHNkay1kb2NzLWNvcmRvdmE6ICJodHRwczovL2dpdGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3Vu\
aWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2NzL21vZHVsZXMvYWVyb2dlYXItcHVzaC1jb3Jk\
b3ZhL3Ryb3VibGVzaG9vdGluZy5hc2NpaWRvYyIKICBzZGstZG9jcy1pb3M6ICJodHRwczovL2dp\
dGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2Nz\
L21vZHVsZXMvYWVyb2dlYXItcHVzaC1pb3MvaW5kZXgubWFya2Rvd24iCiAgc2RrLWRvY3MteGFt\
YXJpbjogImh0dHBzOi8vZ2l0aHViLmNvbS9hZXJvZ2VhcmNhdGFsb2cvdW5pZmllZHB1c2gtYXBi\
L2Jsb2IvbWFzdGVyL2RvY3MvbW9kdWxlcy9hZXJvZ2Vhci1wdXNoLXdpbmRvd3MvaW5kZXgubWFy\
a2Rvd24iCiAgc2VydmljZU5hbWU6IHVwcwogIGJpbmRpbmdzTGltaXQ6IDIKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogUGVyc2lzdGVudCBkZXBsb3ltZW50IG9mIFVQ\
UwogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIG1vYmlsZWNsaWVudF9iaW5kX3Bh\
cmFtZXRlcnNfZGF0YToKICAgICAgICAtICd7Im5hbWUiOiAiQ0xJRU5UX0lEIiwgInZhbHVlIjog\
Im1ldGFkYXRhLm5hbWUiLCAidHlwZSI6ICJwYXRoIn0nCiAgICBwYXJhbWV0ZXJzOiBbXQogICAg\
YmluZF9wYXJhbWV0ZXJzOgogICAgLSBuYW1lOiBDTElFTlRfSUQKICAgICAgcmVxdWlyZWQ6IFRy\
dWUKICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQgSUQKICAgICAgdHlwZTogc3RyaW5nCiAgICAt\
IG5hbWU6IENMSUVOVF9UWVBFCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIHRpdGxlOiBNb2Jp\
bGUgQ2xpZW50IFR5cGUKICAgICAgdHlwZTogZW51bQogICAgICBkZWZhdWx0OiAiQW5kcm9pZCIK\
ICAgICAgZW51bTogWyJBbmRyb2lkIiwgIklPUyJdCiAgICAtIG5hbWU6IGdvb2dsZWtleQogICAg\
ICB0aXRsZTogWW91ciBTZXJ2ZXIgS2V5IGZvciBGaXJlYmFzZSBDbG91ZCBNZXNzYWdpbmcKICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfZ3JvdXA6IEFuZHJvaWQKICAgIC0gbmFtZTog\
cHJvamVjdE51bWJlcgogICAgICB0aXRsZTogWW91ciBTZW5kZXIgSUQsIG5lZWRlZCB0byBjb25u\
ZWN0aW5nIHRvIEZDTQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9ncm91cDogQW5k\
cm9pZAogICAgLSBuYW1lOiBjZXJ0CiAgICAgIHRpdGxlOiBpT1MgLnAxMiBmaWxlIChlbmNvZGUg\
Y29udGVudHMgaW4gYmFzZTY0IGJlZm9yZSBwYXN0aW5nKQogICAgICB0eXBlOiBzdHJpbmcKICAg\
ICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICBkaXNwbGF5X2dyb3VwOiBpT1MKICAgIC0g\
bmFtZTogcGFzc3BocmFzZQogICAgICB0aXRsZTogVGhlIHBhc3NwaHJhc2UKICAgICAgdHlwZTog\
c3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgZGlzcGxheV9ncm91cDog\
aU9TCiAgICAtIG5hbWU6IGlvc0lzUHJvZHVjdGlvbgogICAgICB0aXRsZTogSXMgdGhpcyBhIHBy\
b2R1Y3Rpb24gY2VydGlmaWNhdGU/CiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgIHR5cGU6IGJv\
b2xlYW4KICAgICAgZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICBkaXNwbGF5X2dyb3VwOiBp\
T1MK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb