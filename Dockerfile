FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyIFRlc3QKYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFsCnRh\
Z3M6IAogIC0gbW9iaWxlLXNlcnZpY2UKICAtIG1vYmlsZS1jbGllbnQtZW5hYmxlZAptZXRhZGF0\
YToKICBkaXNwbGF5TmFtZTogVW5pZmllZCBQdXNoIFNlcnZlciBEZXYKICBsb25nRGVzY3JpcHRp\
b246ICJBbiBBUEIgZGVwbG95aW5nIHRoZSBBZXJvR2VhciBVbmlmaWVkUHVzaCBTZXJ2ZXIgd2l0\
aCBwZXJzaXN0ZW50IHN0b3JhZ2UgYW5kIGF1dGhlbnRpY2F0aW9uIHRocm91Z2ggT3BlbnNoaWZ0\
IgogIGltYWdlVXJsOiAiaHR0cHM6Ly9wYnMudHdpbWcuY29tL3Byb2ZpbGVfaW1hZ2VzLzE3OTQ0\
NDAwMDUvYWVyb2dlYXJfaWNvbi0xXzQwMHg0MDAucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJo\
dHRwczovL2dpdGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21h\
c3Rlci9kb2NzL21vZHVsZXMvdXBzX29wZW5zaGlmdC9pbmRleC5hc2NpaWRvYyIKICBwcm92aWRl\
ckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6CiAgICAtICJkb2Nr\
ZXIuaW8vYWVyb2dlYXIvdW5pZmllZHB1c2gtd2lsZGZseS1wbGFpbjoyLjEuMCIKICAgIC0gImRv\
Y2tlci5pby9jZW50b3MvcG9zdGdyZXNxbC05Ni1jZW50b3M3OjkuNiIKICAgIC0gImRvY2tlci5p\
by9hZXJvZ2Vhci91cHMtY29uZmlnLW9wZXJhdG9yOm1hc3RlciIKICAgIC0gImRvY2tlci5pby9v\
cGVuc2hpZnQvb2F1dGgtcHJveHk6djEuMS4wIgogIHNlcnZpY2VOYW1lOiB1cHMKcGxhbnM6CiAg\
LSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogUGVyc2lzdGVudCBkZXBsb3ltZW50IG9m\
IFVQUwogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIG1vYmlsZWNsaWVudF9iaW5k\
X3BhcmFtZXRlcnNfZGF0YToKICAgICAgICAtICd7Im5hbWUiOiAiQ0xJRU5UX0lEIiwgInZhbHVl\
IjogIm1ldGFkYXRhLm5hbWUiLCAidHlwZSI6ICJwYXRoIn0nCiAgICBwYXJhbWV0ZXJzOiAKICAg\
IC0gbmFtZTogU0hBUkVEX1VQUwogICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgdHlwZTogYm9v\
bAogICAgICB0aXRsZTogQ29ubmVjdCB0byBhbiBleGlzdGluZyBVUFMgCiAgICAtIG5hbWU6IFNI\
QVJFRF9IT1NUCiAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
dGl0bGU6IFVSTCBvZiB0aGUgc2hhcmVkIFVQUyBzZXJ2aWNlCiAgICAtIG5hbWU6IFNIQVJFRF9I\
T1NUX1RPS0VOCiAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
dGl0bGU6IEF1dGggdG9rZW4gZm9yIHRoZSBzaGFyZWQgVVBTIHNlcnZpY2UgLSBMZWF2ZSBibGFu\
ayBpZiBub3QgdXNpbmcgc2hhcmVkIFVQUwogICAgYmluZF9wYXJhbWV0ZXJzOgogICAgLSBuYW1l\
OiBDTElFTlRfSUQKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgdGl0bGU6IE1vYmlsZSBDbGll\
bnQgSUQKICAgICAgdHlwZTogc3RyaW5nCiAgICAtIG5hbWU6IENMSUVOVF9UWVBFCiAgICAgIHJl\
cXVpcmVkOiBUcnVlCiAgICAgIHRpdGxlOiBNb2JpbGUgQ2xpZW50IFR5cGUKICAgICAgdHlwZTog\
ZW51bQogICAgICBkZWZhdWx0OiAiQW5kcm9pZCIKICAgICAgZW51bTogWyJBbmRyb2lkIiwgIklP\
UyJdCiAgICAtIG5hbWU6IGdvb2dsZWtleQogICAgICB0aXRsZTogWW91ciBHb29nbGUgS2V5IGZv\
ciBGaXJlYmFzZSBDbG91ZCBNZXNzYWdpbmcKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3Bs\
YXlfZ3JvdXA6IEFuZHJvaWQKICAgIC0gbmFtZTogcHJvamVjdE51bWJlcgogICAgICB0aXRsZTog\
WW91ciBGQ00gUHJvamVjdCBOdW1iZXIsIG5lZWRlZCBvbiB0aGUgbW9iaWxlIGNsaWVudCBmb3Ig\
Y29ubmVjdGluZyB3aXRoIEZDTQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9ncm91\
cDogQW5kcm9pZAogICAgLSBuYW1lOiBjZXJ0CiAgICAgIHRpdGxlOiBpT1MgLnAxMiBmaWxlIChl\
bmNvZGUgY29udGVudHMgaW4gYmFzZTY0IGJlZm9yZSBwYXN0aW5nKQogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0YXJlYQogICAgICBkaXNwbGF5X2dyb3VwOiBpT1MK\
ICAgIC0gbmFtZTogcGFzc3BocmFzZQogICAgICB0aXRsZTogVGhlIHBhc3NwaHJhc2UKICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgZGlzcGxheV9n\
cm91cDogaU9TCiAgICAtIG5hbWU6IGlvc0lzUHJvZHVjdGlvbgogICAgICB0aXRsZTogSXMgdGhp\
cyBhIHByb2R1Y3Rpb24gY2VydGlmaWNhdGU/CiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgIHR5\
cGU6IGJvb2xlYW4KICAgICAgZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICBkaXNwbGF5X2dy\
b3VwOiBpT1MK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb