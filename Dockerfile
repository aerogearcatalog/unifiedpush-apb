FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCiAgLSBtb2JpbGUtY2xpZW50LWVuYWJsZWQKbWV0YWRhdGE6CiAg\
ZGlzcGxheU5hbWU6IFVuaWZpZWQgUHVzaCBTZXJ2ZXIKICBsb25nRGVzY3JpcHRpb246ICJBbiBB\
UEIgZGVwbG95aW5nIHRoZSBBZXJvR2VhciBVbmlmaWVkUHVzaCBTZXJ2ZXIgd2l0aCBwZXJzaXN0\
ZW50IHN0b3JhZ2UgYW5kIGF1dGhlbnRpY2F0aW9uIHRocm91Z2ggT3BlbnNoaWZ0IgogIGltYWdl\
VXJsOiAiaHR0cHM6Ly9wYnMudHdpbWcuY29tL3Byb2ZpbGVfaW1hZ2VzLzE3OTQ0NDAwMDUvYWVy\
b2dlYXJfaWNvbi0xXzQwMHg0MDAucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2dp\
dGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2Nz\
L21vZHVsZXMvdXBzX29wZW5zaGlmdC9pbmRleC5hc2NpaWRvYyIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6CiAgICAtICJkb2NrZXIuaW8vYWVy\
b2dlYXIvdW5pZmllZHB1c2gtd2lsZGZseS1wbGFpbjoyLjEuMCIKICAgIC0gImRvY2tlci5pby9j\
ZW50b3MvcG9zdGdyZXNxbC05Ni1jZW50b3M3OjkuNiIKICAgIC0gImRvY2tlci5pby9hZXJvZ2Vh\
ci91cHMtY29uZmlnLW9wZXJhdG9yOm1hc3RlciIKICAgIC0gImRvY2tlci5pby9vcGVuc2hpZnQv\
b2F1dGgtcHJveHk6djEuMS4wIgogIHNkay1kb2NzLWFuZHJvaWQ6ICJodHRwczovL2dpdGh1Yi5j\
b20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2NzL21vZHVs\
ZXMvYWVyb2dlYXItcHVzaC1hbmRyb2lkL2luZGV4Lm1hcmtkb3duIgogIHNkay1kb2NzLWNvcmRv\
dmE6ICJodHRwczovL2dpdGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9i\
bG9iL21hc3Rlci9kb2NzL21vZHVsZXMvYWVyb2dlYXItcHVzaC1jb3Jkb3ZhL3Ryb3VibGVzaG9v\
dGluZy5hc2NpaWRvYyIKICBzZGstZG9jcy1pb3M6ICJodHRwczovL2dpdGh1Yi5jb20vYWVyb2dl\
YXJjYXRhbG9nL3VuaWZpZWRwdXNoLWFwYi9ibG9iL21hc3Rlci9kb2NzL21vZHVsZXMvYWVyb2dl\
YXItcHVzaC1pb3MvaW5kZXgubWFya2Rvd24iCiAgc2RrLWRvY3MteGFtYXJpbjogImh0dHBzOi8v\
Z2l0aHViLmNvbS9hZXJvZ2VhcmNhdGFsb2cvdW5pZmllZHB1c2gtYXBiL2Jsb2IvbWFzdGVyL2Rv\
Y3MvbW9kdWxlcy9hZXJvZ2Vhci1wdXNoLXdpbmRvd3MvaW5kZXgubWFya2Rvd24iCiAgc2Vydmlj\
ZU5hbWU6IHVwcwpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBQZXJz\
aXN0ZW50IGRlcGxveW1lbnQgb2YgVVBTCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAg\
ICAgbW9iaWxlY2xpZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3sibmFtZSI6\
ICJDTElFTlRfSUQiLCAidmFsdWUiOiAibWV0YWRhdGEubmFtZSIsICJ0eXBlIjogInBhdGgifScK\
ICAgIHBhcmFtZXRlcnM6IFtdCiAgICBiaW5kX3BhcmFtZXRlcnM6CiAgICAtIG5hbWU6IENMSUVO\
VF9JRAogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICB0aXRsZTogTW9iaWxlIENsaWVudCBJRAog\
ICAgICB0eXBlOiBzdHJpbmcKICAgIC0gbmFtZTogQ0xJRU5UX1RZUEUKICAgICAgcmVxdWlyZWQ6\
IFRydWUKICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQgVHlwZQogICAgICB0eXBlOiBlbnVtCiAg\
ICAgIGRlZmF1bHQ6ICJBbmRyb2lkIgogICAgICBlbnVtOiBbIkFuZHJvaWQiLCAiSU9TIl0KICAg\
IC0gbmFtZTogZ29vZ2xla2V5CiAgICAgIHRpdGxlOiBZb3VyIEdvb2dsZSBLZXkgZm9yIEZpcmVi\
YXNlIENsb3VkIE1lc3NhZ2luZwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9ncm91\
cDogQW5kcm9pZAogICAgLSBuYW1lOiBwcm9qZWN0TnVtYmVyCiAgICAgIHRpdGxlOiBZb3VyIEZD\
TSBQcm9qZWN0IE51bWJlciwgbmVlZGVkIG9uIHRoZSBtb2JpbGUgY2xpZW50IGZvciBjb25uZWN0\
aW5nIHdpdGggRkNNCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X2dyb3VwOiBBbmRy\
b2lkCiAgICAtIG5hbWU6IGNlcnQKICAgICAgdGl0bGU6IGlPUyAucDEyIGZpbGUgKGVuY29kZSBj\
b250ZW50cyBpbiBiYXNlNjQgYmVmb3JlIHBhc3RpbmcpCiAgICAgIHR5cGU6IHN0cmluZwogICAg\
ICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgIGRpc3BsYXlfZ3JvdXA6IGlPUwogICAgLSBu\
YW1lOiBwYXNzcGhyYXNlCiAgICAgIHRpdGxlOiBUaGUgcGFzc3BocmFzZQogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICBkaXNwbGF5X2dyb3VwOiBp\
T1MKICAgIC0gbmFtZTogaW9zSXNQcm9kdWN0aW9uCiAgICAgIHRpdGxlOiBJcyB0aGlzIGEgcHJv\
ZHVjdGlvbiBjZXJ0aWZpY2F0ZT8KICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgdHlwZTogYm9v\
bGVhbgogICAgICBkaXNwbGF5X3R5cGU6IGNoZWNrYm94CiAgICAgIGRpc3BsYXlfZ3JvdXA6IGlP\
Uwo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb