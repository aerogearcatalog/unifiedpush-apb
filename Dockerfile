FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHVuaWZpZWRwdXNoLWFwYgpkZXNjcmlwdGlvbjogQWVyb0dlYXIg\
VW5pZmllZFB1c2ggU2VydmVyCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOiAK\
ICAtIG1vYmlsZS1zZXJ2aWNlCiAgLSBtb2JpbGUtY2xpZW50LWVuYWJsZWQKbWV0YWRhdGE6CiAg\
ZGlzcGxheU5hbWU6IFB1c2ggTm90aWZpY2F0aW9ucwogIGxvbmdEZXNjcmlwdGlvbjogIkFuIEFQ\
QiBkZXBsb3lpbmcgdGhlIEFlcm9HZWFyIFVuaWZpZWRQdXNoIFNlcnZlciB3aXRoIHBlcnNpc3Rl\
bnQgc3RvcmFnZSBhbmQgYXV0aGVudGljYXRpb24gdGhyb3VnaCBPcGVuc2hpZnQiCiAgaW1hZ2VV\
cmw6ICJodHRwczovL3Bicy50d2ltZy5jb20vcHJvZmlsZV9pbWFnZXMvMTc5NDQ0MDAwNS9hZXJv\
Z2Vhcl9pY29uLTFfNDAweDQwMC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDogImh0dHBzOi8vZG9j\
cy5hZXJvZ2Vhci5vcmcvZXh0ZXJuYWwvYXBiL3VuaWZpZWRwdXNoLmh0bWwiCiAgcHJvdmlkZXJE\
aXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAgZGVwZW5kZW5jaWVzOgogICAgLSAiZG9ja2Vy\
LmlvL2Flcm9nZWFyL3VuaWZpZWRwdXNoLXdpbGRmbHktcGxhaW46Mi4xLjAiCiAgICAtICJkb2Nr\
ZXIuaW8vY2VudG9zL3Bvc3RncmVzcWwtOTYtY2VudG9zNzo5LjYiCiAgICAtICJkb2NrZXIuaW8v\
YWVyb2dlYXIvdXBzLWNvbmZpZy1vcGVyYXRvcjptYXN0ZXIiCiAgICAtICJkb2NrZXIuaW8vb3Bl\
bnNoaWZ0L29hdXRoLXByb3h5OnYxLjEuMCIKICBzZGstZG9jcy1hbmRyb2lkOiAiaHR0cHM6Ly9k\
b2NzLmFlcm9nZWFyLm9yZy9hbmRyb2lkLXNkay9sYXRlc3QvZ2V0dGluZy1zdGFydGVkL3B1c2gu\
aHRtbCIKICBzZGstZG9jcy1jb3Jkb3ZhOiAiaHR0cHM6Ly9naXRodWIuY29tL2Flcm9nZWFyY2F0\
YWxvZy91bmlmaWVkcHVzaC1hcGIvYmxvYi9tYXN0ZXIvZG9jcy9tb2R1bGVzL2Flcm9nZWFyLXB1\
c2gtY29yZG92YS90cm91Ymxlc2hvb3RpbmcuYXNjaWlkb2MiCiAgc2RrLWRvY3MtaW9zOiAiaHR0\
cHM6Ly9naXRodWIuY29tL2Flcm9nZWFyY2F0YWxvZy91bmlmaWVkcHVzaC1hcGIvYmxvYi9tYXN0\
ZXIvZG9jcy9tb2R1bGVzL2Flcm9nZWFyLXB1c2gtaW9zL2luZGV4Lm1hcmtkb3duIgogIHNkay1k\
b2NzLXhhbWFyaW46ICJodHRwczovL2dpdGh1Yi5jb20vYWVyb2dlYXJjYXRhbG9nL3VuaWZpZWRw\
dXNoLWFwYi9ibG9iL21hc3Rlci9kb2NzL21vZHVsZXMvYWVyb2dlYXItcHVzaC13aW5kb3dzL2lu\
ZGV4Lm1hcmtkb3duIgogIHNlcnZpY2VOYW1lOiB1cHMKICBiaW5kaW5nc0xpbWl0OiAyCnBsYW5z\
OgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFBlcnNpc3RlbnQgZGVwbG95bWVu\
dCBvZiBVUFMKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBtb2JpbGVjbGllbnRf\
YmluZF9wYXJhbWV0ZXJzX2RhdGE6CiAgICAgICAgLSAneyJuYW1lIjogIkNMSUVOVF9JRCIsICJ2\
YWx1ZSI6ICJtZXRhZGF0YS5uYW1lIiwgInR5cGUiOiAicGF0aCJ9JwogICAgcGFyYW1ldGVyczog\
W10KICAgIGJpbmRfcGFyYW1ldGVyczoKICAgIC0gbmFtZTogQ0xJRU5UX0lECiAgICAgIHJlcXVp\
cmVkOiBUcnVlCiAgICAgIHRpdGxlOiBNb2JpbGUgQ2xpZW50IElECiAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgLSBuYW1lOiBDTElFTlRfVFlQRQogICAgICByZXF1aXJlZDogVHJ1ZQogICAgICB0aXRs\
ZTogTW9iaWxlIENsaWVudCBUeXBlCiAgICAgIHR5cGU6IGVudW0KICAgICAgZGVmYXVsdDogIkFu\
ZHJvaWQiCiAgICAgIGVudW06IFsiQW5kcm9pZCIsICJJT1MiXQogICAgLSBuYW1lOiBnb29nbGVr\
ZXkKICAgICAgdGl0bGU6IFlvdXIgU2VydmVyIEtleSBmb3IgRmlyZWJhc2UgQ2xvdWQgTWVzc2Fn\
aW5nCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X2dyb3VwOiBBbmRyb2lkCiAgICAt\
IG5hbWU6IHByb2plY3ROdW1iZXIKICAgICAgdGl0bGU6IFlvdXIgU2VuZGVyIElELCBuZWVkZWQg\
dG8gY29ubmVjdGluZyB0byBGQ00KICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfZ3Jv\
dXA6IEFuZHJvaWQKICAgIC0gbmFtZTogY2VydAogICAgICB0aXRsZTogaU9TIC5wMTIgZmlsZSAo\
ZW5jb2RlIGNvbnRlbnRzIGluIGJhc2U2NCBiZWZvcmUgcGFzdGluZykKICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgIGRpc3BsYXlfdHlwZTogdGV4dGFyZWEKICAgICAgZGlzcGxheV9ncm91cDogaU9T\
CiAgICAtIG5hbWU6IHBhc3NwaHJhc2UKICAgICAgdGl0bGU6IFRoZSBwYXNzcGhyYXNlCiAgICAg\
IHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIGRpc3BsYXlf\
Z3JvdXA6IGlPUwogICAgLSBuYW1lOiBpb3NJc1Byb2R1Y3Rpb24KICAgICAgdGl0bGU6IElzIHRo\
aXMgYSBwcm9kdWN0aW9uIGNlcnRpZmljYXRlPwogICAgICBkZWZhdWx0OiBmYWxzZQogICAgICB0\
eXBlOiBib29sZWFuCiAgICAgIGRpc3BsYXlfdHlwZTogY2hlY2tib3gKICAgICAgZGlzcGxheV9n\
cm91cDogaU9TCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb